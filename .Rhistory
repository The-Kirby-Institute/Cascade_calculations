# Clear workspace
rm(list=ls())
# Libraries for data manipulation
require(readxl)
require(dplyr)
require(tidyr)
require(utils)
# Libraries for output
require(ggplot2)
require(knitr)
require(gridExtra)
require(RColorBrewer)
# Set working directory
setwd(file.path(path.expand("~"),"Research","!Evaluation_Modelling","project_care_cascades"))
# Base directory
basePath <- getwd()
dataFolder <- file.path(basePath,"data")
# Folder for plots
outputFolder <- file.path(basePath,"output")
# Primary script parameters
currTime <- format(Sys.time(), "%y-%m-%d") # to append to files
analysisYear <- 2013
startYear <- 1990
# reclean <- FALSE  # Rerun data cleaning if true otherwise load already cleaned file.
pop <- "all"  # Population exposure category
region <- "all" # State for analysis
# TODO: Think about doing cumulative diagnoses for each state and population everytime
# Load clean file
hivdata <- read.csv(file.path(cleanDataFolder, paste("hivnotifications",
toString(analysisYear),".csv", sep ="")))
# Setup overarching analysis
years <- startYear:analysisYear # Years to calculate and plot
# Setup extra columns for analysis
hivdata$yeardiagnosis <- as.numeric(substr(hivdata$datediagnosis,1,4))
hivdata$yeardeath <- as.numeric(substr(hivdata$datedeath,1,4))
allyears <- min(hivdata$yeardiagnosis):analysisYear # All years of data
# Quick checks that we are not doing analysis outside of the data.
if (max(hivdata$yeardiagnosis) < analysisYear) {
stop("No data for specified for final year of analysis.")
}
if (min(hivdata$yeardiagnosis) > startYear) {
stop("No data for specified for first year of analysis.")
}
# Setup our working data frame
hivset <- hivdata
hivdata <- read.csv(file.path(cleanDataFolder, paste("hivnotifications",
toString(analysisYear),".csv", sep ="")))
hivdata <- read.csv(file.path(dataFolder, paste("hivnotifications",
toString(analysisYear),".csv", sep ="")))
